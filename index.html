<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Rozgaar Saathi</title>
    <link rel="stylesheet" href="style.css">
    <!-- Razorpay SDK -->
    <script src="https://checkout.razorpay.com/v1/checkout.js"></script>
    <!-- Supabase SDK -->
    <script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2"></script>
</head>
<body>

    <!-- Header -->
    <header>
        <h1>Rozgaar Saathi</h1>
        <button id="logoutBtn" class="hidden">Logout</button>
    </header>

    <!-- Main Container -->
    <main id="app">
        
        <!-- SCREEN 1: Role Selection -->
        <section id="role-selection" class="view">
            <h2>Are you an Employer or a Worker?</h2>
            <div class="card-container">
                <button onclick="selectRole('employer')" class="role-btn">Employer (Jobs Provider)</button>
                <button onclick="selectRole('worker')" class="role-btn">Worker (Job Seeker)</button>
            </div>
        </section>

        <!-- SCREEN 1.5: Language Selection (Worker Only) -->
        <section id="language-selection" class="view hidden">
            <h2>Select Language / भाषा चुनें / ਭਾਸ਼ਾ ਚੁਣੋ</h2>
            <div class="btn-group">
                <button onclick="setLanguage('en')">English</button>
                <button onclick="setLanguage('hi')">Hindi (हिंदी)</button>
                <button onclick="setLanguage('pb')">Punjabi (ਪੰਜਾਬੀ)</button>
            </div>
        </section>

        <!-- SCREEN 2: Auth (Login/Signup) -->
        <section id="auth-screen" class="view hidden">
            <h2 data-i18n="login_title">Login or Signup</h2>
            <p id="auth-message"></p>
            <form id="auth-form">
                <input type="email" id="email" placeholder="Email" required>
                <input type="password" id="password" placeholder="Password" required>
                <button type="submit" data-i18n="continue_btn">Continue</button>
            </form>
        </section>

        <!-- SCREEN 3: Profile Onboarding -->
        <section id="onboarding-screen" class="view hidden">
            <h2 data-i18n="complete_profile">Complete Your Profile</h2>
            <form id="profile-form">
                <div class="form-group">
                    <label data-i18n="upload_photo">Upload Photo:</label>
                    <input type="file" id="profile-photo" accept="image/*" required>
                </div>
                
                <div id="worker-category-input" class="hidden">
                    <label data-i18n="select_category">Category:</label>
                    <select id="category">
                        <option value="Labour">Labour Worker</option>
                        <option value="Carpenter">Carpenter</option>
                        <option value="Maid">Maid</option>
                        <option value="Cook">Cook</option>
                        <option value="Cleaner">Home Cleaner</option>
                        <option value="Electrician">Electrician</option>
                        <option value="Plumber">Plumber</option>
                    </select>
                </div>

                <input type="text" id="full-name" placeholder="Full Name" required>
                <input type="tel" id="phone" placeholder="Phone Number" required>
                
                <select id="state">
                    <option value="Delhi">Delhi</option>
                    <option value="Punjab">Punjab</option>
                    <option value="Haryana">Haryana</option>
                    <option value="Maharashtra">Maharashtra</option>
                </select>

                <select id="city">
                    <option value="New Delhi">New Delhi</option>
                    <option value="Ludhiana">Ludhiana</option>
                    <option value="Gurgaon">Gurgaon</option>
                    <option value="Mumbai">Mumbai</option>
                </select>

                <textarea id="address" placeholder="Full Address" required></textarea>
                
                <button type="submit" data-i18n="save_profile">Save Profile</button>
            </form>
        </section>

        <!-- SCREEN 4: Employer Dashboard (Search) -->
        <section id="employer-dashboard" class="view hidden">
            <h2>Find a Worker</h2>
            <div class="search-bar">
                <select id="search-category">
                    <option value="Labour">Labour Worker</option>
                    <option value="Carpenter">Carpenter</option>
                    <option value="Maid">Maid</option>
                    <option value="Cook">Cook</option>
                    <option value="Cleaner">Home Cleaner</option>
                    <option value="Electrician">Electrician</option>
                    <option value="Plumber">Plumber</option>
                </select>
                <button onclick="findWorkers()">Search</button>
            </div>
            <div id="workers-list" class="list-container"></div>
        </section>

        <!-- SCREEN 5: Worker Dashboard (Waiting) -->
        <section id="worker-dashboard" class="view hidden">
            <h2 data-i18n="dashboard_title">My Dashboard</h2>
            <div class="status-card">
                <p><span data-i18n="status_label">Status:</span> <strong class="active-status" data-i18n="waiting_msg">Waiting for jobs...</strong></p>
            </div>
            <div id="notification-area" class="hidden">
                <div class="alert">
                    <h3 data-i18n="new_job">You have been hired!</h3>
                    <p id="employer-details"></p>
                    <button onclick="acceptJob()" data-i18n="start_job">Start Job</button>
                </div>
            </div>
            
            <!-- OTP Entry for Worker -->
            <div id="worker-otp-section" class="hidden">
                <h3 data-i18n="enter_otp">Enter Employer's OTP</h3>
                <input type="text" id="job-otp-input" placeholder="6-digit OTP" maxlength="6">
                <button onclick="verifyOtp()" data-i18n="verify_otp">Verify & Complete</button>
            </div>
        </section>

        <!-- SCREEN 6: Employer Job Active (Show OTP) -->
        <section id="employer-job-screen" class="view hidden">
            <h2>Job in Progress</h2>
            <div class="otp-card">
                <p>Give this OTP to the worker when the job is done:</p>
                <h1 id="generated-otp">------</h1>
            </div>
            <p>Worker: <span id="hired-worker-name"></span></p>
            <div id="employer-completion-msg" class="hidden success-msg">
                Job Completed Successfully!
            </div>
        </section>

    </main>

    <script src="script.js"></script>
</body>
</html>